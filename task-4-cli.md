# **Task-4-Cli: Консольний інтерфейс для управління поїздками**

Це завдання показує, що твій бізнес-код (домен + сервіси + репозиторій) може жити **поза вебом**.
Ти створиш простий **CLI (command line interface)**, який працює з поїздками через ту ж бізнес-логіку, що і FastAPI.


## **1. Загальна ідея**

Створити Python-скрипт, який запускається з консолі та дозволяє:

* створювати поїздки
* переглядати список поїздок
* шукати поїздки за містами
* бронювати місця
* скасовувати бронювання
* дивитися статистику

Всі операції мають використовувати **існуючі сервісні функції** та **репозиторій** (бажано `SQLiteTripRepository` з Task-3).


## **2. Технічні вимоги**

### 2.1. Окремий файл для CLI

Створити файл, наприклад:

`cli.py`

У ньому реалізувати консольний інтерфейс.


### 2.2. Інструмент для парсингу аргументів

Використати стандартний модуль:

* `argparse`

CLI має підтримувати **сабкоманди**, наприклад:

* `create-trip`
* `list-trips`
* `search-trips`
* `book-seat`
* `cancel-seat`
* `stats`

**Хінт:**
Подивись приклади `argparse` з субкомандами (`add_subparsers()`).


### 2.3. Команди та параметри

#### 1) `create-trip`

Приклад виклику:

```bash
python cli.py create-trip \
  --from-city Kyiv \
  --to-city Lviv \
  --departure "2025-01-01T12:00:00" \
  --seats-total 3 \
  --price 500 \
  --driver-name "Ivan"
```

Поведінка:

* розпарсити аргументи
* викликати сервіс створення поїздки
* вивести інформацію про створену поїздку (id, напрями, час)


#### 2) `list-trips`

```bash
python cli.py list-trips
```

Показує всі поїздки.

Мінімальний формат:

`[id] from_city -> to_city, departure_time, seats_taken/seats_total, price`


#### 3) `search-trips`

```bash
python cli.py search-trips --from-city Kyiv --to-city Lviv
```

Аргументи необов’язкові:

* `--from-city` (опціонально)
* `--to-city` (опціонально)

Використовує твою сервісну функцію пошуку.


#### 4) `book-seat`

```bash
python cli.py book-seat --trip-id 1
```

* Викликає сервіс бронювання місця
* Виводить оновлений стан поїздки (або повідомлення про помилку)


#### 5) `cancel-seat`

```bash
python cli.py cancel-seat --trip-id 1
```

* Викликає сервіс скасування бронювання
* Виводить оновлений стан поїздки (або повідомлення про помилку)


#### 6) `stats`

```bash
python cli.py stats
```

Виводить:

* загальну кількість поїздок
* суму вільних місць


## **3. Використання репозиторію**

CLI має використовувати **той самий репозиторій**, що і інші частини системи.

Рекомендація:

* використовувати `SQLiteTripRepository("trips.db")`
  (якщо реалізований в Task-3),
* але важливо, щоб код був організований так, що можна замінити реалізацію при потребі.

**Хінт:**
Логіку підключення репозиторію можна винести у окрему функцію, напр.:

```python
def get_repo():
    return SQLiteTripRepository("trips.db")
```


## **4. Поведінка помилок**

Якщо щось пішло не так:

* не падаємо з traceback’ом без пояснення
* перехоплюємо `ValueError` з сервісів
* показуємо читабельне повідомлення для користувача (наприклад:
  `Помилка: немає вільних місць`, `Помилка: поїздку не знайдено`)


## **5. Formating output**

Не потрібно робити красу з табличками, достатньо простих рядків.

Приклади:

```text
[1] Kyiv -> Lviv at 2025-01-01T12:00:00, seats 1/3, price 500.0
[2] Kyiv -> Odessa at 2025-01-02T09:00:00, seats 0/2, price 600.0
```

або

```text
Створено поїздку:
[id=3] Kyiv -> Lviv at 2025-01-01T12:00:00, seats 0/3, price 500
```


## **6. Що потрібно здати**

1. Файл `cli.py` із реалізацією команд.
2. Короткий опис у README:

   * як викликати кожну команду (з прикладами)
3. Оновлення `prompts.txt`, якщо користувався AI:

   * додай промпти, які використовував для розробки CLI
   * коротко оцінюй користь кожного (0–10)


## **Acceptance Criteria**

* CLI запускається через `python cli.py ...`
* Є щонайменше 5 команд: `create-trip`, `list-trips`, `search-trips`, `book-seat`, `cancel-seat`, `stats`
* Всі команди використовують бізнес-логіку (сервіси) та репозиторій
* Дані зберігаються в БД (якщо використовується SQLite)
* Помилки обробляються і виводяться зрозумілою мовою
* README містить приклади запуску


## **Невеликі інсайти для trainee**

* Це завдання показує, що **домен і сервіси — головні**, а веб/CLI — лише різні “обгортки”.
* Якщо ти можеш підключити один і той самий бізнес-шар до FastAPI та CLI — ти рухаєшся в напрямку правильної архітектури.
* `argparse` — це базовий інструмент, який варто знати кожному Python-розробнику.
* В реальних системах одна й та сама логіка часто доступна через:

  * HTTP API
  * CLI
  * фонові задачі / worker-и
